---
title: "Module 6 — Transportation Model (Heart Start AED)"
author: "Jaipreet Kaur"
output:
  pdf_document:
    toc: true
    toc_depth: '2'
  html_document:
    toc: true
    toc_depth: 2
    number_sections: true
---

# Problem summary

We have two plants (A, B) that produce automated external defibrillators (AEDs) and ship to three wholesalers (W1, W2, W3). We must **minimize total cost = production cost (by plant) + shipping cost (by route)** while meeting each warehouse's demand and not exceeding each plant's capacity.

**Data**

|            | W1 ship | W2 ship | W3 ship | Unit Prod. Cost | Capacity |
|------------|:------:|:------:|:------:|:----------------:|:--------:|
| **Plant A**|   22   |   14   |   30   |       600        |   100    |
| **Plant B**|   16   |   20   |   24   |       625        |   120    |

Warehouse monthly demand: **W1 = 80**, **W2 = 60**, **W3 = 70** (total 210). Total available capacity is 220, so we will only produce what we need.

# Linear program (LP) formulation

Decision variables (units):  
- \(x_{A1}, x_{A2}, x_{A3}\): units from Plant A → W1, W2, W3  
- \(x_{B1}, x_{B2}, x_{B3}\): units from Plant B → W1, W2, W3

Objective (production + shipping, $/unit shown in parentheses):  
\(
\min \; 622x_{A1} + 614x_{A2} + 630x_{A3}
+ 641x_{B1} + 645x_{B2} + 649x_{B3}
\)

Subject to demands:  
\(
\begin{aligned}
x_{A1} + x_{B1} &= 80 \\
x_{A2} + x_{B2} &= 60 \\
x_{A3} + x_{B3} &= 70
\end{aligned}
\)

Plant capacities:  
\(
\begin{aligned}
x_{A1} + x_{A2} + x_{A3} &\le 100 \\
x_{B1} + x_{B2} + x_{B3} &\le 120
\end{aligned}
\)

Nonnegativity: all \(x \ge 0\).

# Solve in R (`lpSolve`)

```r
# install.packages("lpSolve") # uncomment if needed
library(lpSolve)

# Cost vector (production + shipping)
# order: A1, A2, A3, B1, B2, B3
costs <- c(600+22, 600+14, 600+30, 625+16, 625+20, 625+24)

# Constraints
# Demands (equalities)
A_eq <- rbind(
  c(1,0,0, 1,0,0),  # W1: x_A1 + x_B1 = 80
  c(0,1,0, 0,1,0),  # W2: x_A2 + x_B2 = 60
  c(0,0,1, 0,0,1)   # W3: x_A3 + x_B3 = 70
)
b_eq <- c(80, 60, 70)

# Capacities (inequalities)
A_ub <- rbind(
  c(1,1,1, 0,0,0),  # A capacity
  c(0,0,0, 1,1,1)   # B capacity
)
b_ub <- c(100, 120)

# Combine to a single lp() call:
# We'll build 'const.mat', 'const.dir', 'const.rhs'
const.mat <- rbind(A_eq, A_ub)
const.dir <- c("=", "=", "=", "<=", "<=")
const.rhs <- c(b_eq, b_ub)

# Solve
sol <- lp(direction = "min", objective.in = costs,
          const.mat = const.mat, const.dir = const.dir, const.rhs = const.rhs,
          all.int = FALSE)  # continuous variables

sol$status           # 0 means optimal
sol$objval           # minimal total cost
sol$solution         # decision variables

# Tidy output
vars <- data.frame(
  variable = c("x_A1","x_A2","x_A3","x_B1","x_B2","x_B3"),
  value = round(sol$solution, 4)
)
vars

# Production by plant
prod_A <- sum(sol$solution[1:3])
prod_B <- sum(sol$solution[4:6])
c(PlantA = prod_A, PlantB = prod_B)
```

# Expected optimal solution

The optimal shipping plan is:

- \(x_{A1}=40\), \(x_{A2}=60\), \(x_{A3}=0\)  
- \(x_{B1}=40\), \(x_{B2}=0\), \(x_{B3}=70\)

Production totals: **Plant A = 100**, **Plant B = 110**.  
Minimum total cost: **$132,790**.

# Files

The CPLEX LP version of the model is provided alongside this Rmd as `module6_model.lp`.
